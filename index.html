<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="icon" href="/assets/images/favicon.png" type="image/png" />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Theo Grigorenko</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <link rel="stylesheet" href="styles.css" />
  </head>

  <body>
    <div class="container">
      <section id="about">
        <video
          class="logo-video"
          muted
          playsinline
          preload="none"
          data-src="assets/videos/logo.mp4"
          oncontextmenu="return false;"
        ></video>
        <h2 class="section-title">About Me</h2>
        <div class="about-card">
          <p>
            Hello! I'm Theo Grigorenko, a high school student interested in
            numerical simulations and applied artificial intelligence
            (especially with robotics).
          </p>
          <p>
            Please scroll to see the projects below and learn more about them.
          </p>
        </div>
      </section>

      <section id="video-showcase">
        <h2 class="section-title">Robotics Project</h2>
        <div class="about-card">
          <div class="drone-videos-layout">
            <div class="media-item version-4">
              <div class="media-wrapper video-wrapper-vertical">
                <video
                  controls
                  muted
                  playsinline
                  preload="none"
                  data-src="assets/videos/Version4.webm"
                ></video>
              </div>
              <p class="media-description">Latest version</p>
            </div>

            <div class="right-videos">
              <div class="media-item">
                <div class="media-wrapper video-wrapper">
                  <video
                    controls
                    muted
                    playsinline
                    preload="none"
                    data-src="assets/videos/Version3.webm"
                  ></video>
                </div>
              </div>
              <div class="media-item">
                <div class="media-wrapper video-wrapper">
                  <video
                    controls
                    muted
                    playsinline
                    preload="none"
                    data-src="assets/videos/Version2.webm"
                  ></video>
                </div>
              </div>
            </div>
          </div>

          <div class="drone-designs-container">
            <div class="swiper drone-designs-swiper">
              <div class="swiper-wrapper">
                <div class="swiper-slide" data-design="1">
                  <div class="media-item">
                    <div class="media-wrapper design-wrapper">
                      <img
                        data-src="assets/images/Design1.png"
                        src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="
                        alt="Design 1"
                      />
                    </div>
                    <p class="media-description">Design 1</p>
                  </div>
                </div>
                <div class="swiper-slide" data-design="2">
                  <div class="media-item">
                    <div class="media-wrapper design-wrapper">
                      <img
                        data-src="assets/images/Design2.png"
                        src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="
                        alt="Design 2"
                      />
                    </div>
                    <p class="media-description">Design 2</p>
                  </div>
                </div>
                <div class="swiper-slide" data-design="3">
                  <div class="media-item">
                    <div class="media-wrapper design-wrapper">
                      <img
                        data-src="assets/images/Design3.png"
                        src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="
                        alt="Design 3"
                      />
                    </div>
                    <p class="media-description">Design 3</p>
                  </div>
                </div>
              </div>
              <div class="swiper-pagination"></div>
              <div class="swiper-button-prev"></div>
              <div class="swiper-button-next"></div>
            </div>
          </div>

          <p>
            Accurate drone tracking with a laser using custom-trained
            <b>object detection (YOLOv4)</b> and
            <b>optimal control (Kalman filter)</b>.
          </p>
          <p>This project accurately tracks a drone with a laser.</p>
          <p>
            It detects the drone from a <b>live video feed</b> from an iPhone
            using the <b>YOLOv4 model</b> which was trained on a self-collected
            and annotated dataset.
          </p>
          <p>
            The camera distortion (pixel to motor angle) and laser position
            (pixel offset depending on distance of the drone) are
            <b>calibrated</b>.
          </p>
          <p>
            Two stepper motors controlled with an <b>Arduino</b> rotate the
            camera and laser to track the position of the drone.
          </p>
          <p>
            A <b>Kalman filter</b> is used to smooth the tracking and predict
            the future position of the drone.
          </p>
        </div>
      </section>

      <section id="projects">
        <div class="project-header">
          <h2 id="projects-title" class="section-title">Projects:</h2>
          <div class="project-buttons">
            <button class="project-btn" data-id="satya">Satya</button
            ><span class="separator">,</span>
            <button class="project-btn" data-id="ev">Electric Vehicle</button>
          </div>
        </div>

        <div class="featured-projects">
          <div class="project" data-id="satya">
            <h3>Satya</h3>
            <div class="media-item">
              <div class="media-wrapper">
                <video
                  controls
                  muted
                  playsinline
                  preload="none"
                  data-src="assets/videos/satya-video.webm"
                ></video>
              </div>
              <p class="media-description">
                Voting functionality on the Satya app
              </p>
            </div>
            <p>
              Satya is an <b>information consensus platform</b> for experts to
              monetarily back or challenge statements.
            </p>
            <p>
              Experts are able to build their expertise through voting which is
              <b>optimally weighed</b> to maximize the accuracy of the
              consensus.
            </p>
          </div>

          <div class="project" data-id="ev">
            <h3>Electric Vehicle (SciOly Event)</h3>
            <div class="media-item">
              <div class="media-wrapper">
                <video
                  controls
                  muted
                  playsinline
                  preload="none"
                  data-src="assets/videos/ev-video.webm"
                ></video>
              </div>
              <p class="media-description">New York State performance</p>
            </div>
            <p>
              Science Olympiad event with the objective of a miniature electric
              vehicle traveling a distance (8 meters to 10 meters) with the
              <b>greatest accuracy and speed</b>.
            </p>
            <p>
              I won a <b>silver medal</b> at the New York State competition
              (2025) using a <b>PID controller</b> to modulate the voltage
              applied to the motor.
            </p>
          </div>
        </div>

        <div class="selected-project-container">
          <!-- Satya -->
          <div class="selected-project" data-id="satya">
            <div class="media-item">
              <div class="media-wrapper">
                <video
                  controls
                  muted
                  playsinline
                  preload="none"
                  data-src="assets/videos/satya-video.webm"
                ></video>
              </div>
              <p class="media-description">
                Voting functionality on the Satya app
              </p>
            </div>

            <div class="images-container">
              <div class="media-item">
                <div class="media-wrapper">
                  <img
                    data-src="assets/images/satya-image1.png"
                    src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="
                    alt="Satya image 1"
                  />
                </div>
                <p class="media-description">
                  Resilience of estimation simulation
                </p>
              </div>
              <div class="media-item">
                <div class="media-wrapper">
                  <img
                    data-src="assets/images/satya-image2.png"
                    src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="
                    alt="Satya image 2"
                  />
                </div>
                <p class="media-description">
                  Experience estimation simulation
                </p>
              </div>
            </div>
            <p>
              Satya is an <b>information consensus platform</b> for experts to
              monetarily back or challenge statements.
            </p>
            <p>
              Experts are able to build their expertise through voting which is
              <b>optimally weighed</b> to maximize the accuracy of the
              consensus.
            </p>
            <p>
              The charts and graphs above show a simulation of random truthful
              and malicious agents assigned an intelligence value. The agents
              are then given statements to vote on, and the simulation shows how
              the estimation of agents' experience changes over time and the
              resilience of estimation.
            </p>

            <p>The app is available on Windows and iOS.</p>
            <div
              style="
                width: 100%;
                margin-bottom: 1em;
                display: flex;
                justify-content: space-around;
              "
            >
              <a
                href="https://satya-website.vercel.app/"
                target="_blank"
                class="button bigger_button"
                >Learn More on Satya's Website</a
              >
            </div>
            <div
              style="
                width: 100%;
                margin-bottom: 1em;
                display: flex;
                justify-content: space-around;
              "
            >
              <div class="whitepaper-section" id="whitepaper-section">
                <iframe
                  data-src="assets/pdfs/whitepaper.pdf"
                  frameborder="0"
                  class="whitepaper"
                  id="whitepaper"
                ></iframe>
              </div>
            </div>
          </div>

          <!-- EV -->
          <div class="selected-project" data-id="ev">
            <div class="media-item">
              <div class="media-wrapper">
                <video
                  controls
                  muted
                  playsinline
                  preload="none"
                  data-src="assets/videos/ev-video.webm"
                ></video>
              </div>
              <p class="media-description">New York State performance</p>
            </div>
            <div class="images-container">
              <div class="media-item">
                <div class="media-wrapper">
                  <img
                    data-src="assets/images/ev-image1.webp"
                    src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="
                    alt="Electric Vehicle image 1"
                  />
                </div>
                <p class="media-description">Silver medal ðŸŽ‰</p>
              </div>
              <div class="media-item">
                <div class="media-wrapper">
                  <img
                    data-src="assets/images/ev-image2.png"
                    src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="
                    alt="Electric Vehicle image 2"
                  />
                </div>
                <p class="media-description">Simulation of optimal control</p>
              </div>
            </div>
            <p>
              Science Olympiad event with the objective of a miniature electric
              vehicle traveling a distance (8 meters to 10 meters) with the
              <b>greatest accuracy and speed</b>.
            </p>
            <p>
              I won a <b>silver medal</b> at the New York State competition
              (2025) using a <b>PID controller</b> to modulate the voltage
              applied to the motor.
            </p>
          </div>
        </div>
      </section>
    </div>

    <footer>Â© 2025 Theo Grigorenko</footer>

    <script>
      document.querySelectorAll("video[data-src]").forEach((video) => {
        function onFirstPlay(e) {
          // only trigger if no src yet
          if (!video.src && video.dataset.src) {
            e.preventDefault(); // stop the no-op
            video.removeEventListener("play", onFirstPlay);

            // 1) point src at the real URL so browser starts fetching & shows its spinner
            video.src = video.dataset.src;
            // 2) load+play
            video.load();
            video.play().catch(() => {});
          }
        }
        video.addEventListener("play", onFirstPlay);
      });

      const blobUrlCache = new Map();
      const getBlobUrl = (url) => {
        if (!blobUrlCache.has(url)) {
          blobUrlCache.set(
            url,
            fetch(url)
              .then((r) => r.blob())
              .then((b) => URL.createObjectURL(b))
          );
        }
        return blobUrlCache.get(url);
      };

      /* Configure basic attributes synchronously */
      document.querySelectorAll("video").forEach((v) => {
        v.muted = true;
        v.playsinline = true;
        if (!v.classList.contains("logo-video")) v.controls = true;
      });

      /* â”€â”€â”€ MAIN LOADING PIPELINE â”€â”€â”€ */
      window.addEventListener("load", async () => {
        /* 1 â€” Logo video */
        const logo = document.querySelector("video.logo-video[data-src]");
        if (logo) {
          try {
            logo.src = await getBlobUrl(logo.dataset.src);
            logo.load();
            logo.play().catch(() => {});
          } catch (e) {
            console.warn("Logo video failed:", e);
          }
        }

        /* 1b â€” Version video posters in order: 4, 3, 2 */
        const loadPoster = (video) => {
          const poster = video.dataset.src.replace(/\.\w+$/, ".webp");
          video.poster = poster;
          return new Promise((res) => {
            const img = new Image();
            img.onload = img.onerror = res;
            img.src = poster;
          });
        };

        const version4 = document.querySelector('video[data-src*="Version4"]');
        const version3 = document.querySelector('video[data-src*="Version3"]');
        const version2 = document.querySelector('video[data-src*="Version2"]');

        if (version4) await loadPoster(version4);
        if (version3) await loadPoster(version3);
        if (version2) await loadPoster(version2);

        /* 2 â€” Design images in order: 1, 2, 3 */
        const loadImage = (img) => {
          return new Promise((res) => {
            img.onload = img.onerror = res;
            img.src = img.dataset.src;
          });
        };

        const design1 = document.querySelector('img[data-src*="Design1"]');
        const design2 = document.querySelector('img[data-src*="Design2"]');
        const design3 = document.querySelector('img[data-src*="Design3"]');

        if (design1) await loadImage(design1);
        if (design2) await loadImage(design2);
        if (design3) await loadImage(design3);

        /* 3 â€” Hero video posters (satya, drone, ev) */
        const heroVids = Array.from(
          document.querySelectorAll(
            'video[data-src*="satya-video"],video[data-src*="drone-video"],video[data-src*="ev-video"]'
          )
        );

        await Promise.all(heroVids.map(loadPoster));

        /* 4 â€” Remaining inline <img> elements */
        document
          .querySelectorAll("img[data-src]")
          .forEach((img) => {
            if (!img.src || img.src.includes("base64")) {
              img.src = img.dataset.src;
            }
          });

        /* 5 â€” Posters for any remaining videos */
        const allVideos = Array.from(
          document.querySelectorAll("video[data-src]:not(.logo-video)")
        );
        const extraPosterPromises = allVideos
          .filter((v) => !v.poster)
          .map(loadPoster);

        await Promise.all(extraPosterPromises);

        /* 6 â€” Finally load EVERY video file */
        const groups = allVideos.reduce((acc, el) => {
          (acc[el.dataset.src] ??= []).push(el);
          return acc;
        }, {});

        await Promise.all(
          Object.entries(groups).map(async ([url, els]) => {
            try {
              const blobUrl = await getBlobUrl(url);
              els.forEach((v) => {
                v.src = blobUrl;
                v.load();
              });
            } catch (e) {
              console.warn("Video failed:", url, e);
            }
          })
        );

        /* 7 â€” Now load the whitepaper PDF */
        const pdfEl = document.getElementById("whitepaper");
        if (pdfEl && pdfEl.dataset.src) {
          pdfEl.src = pdfEl.dataset.src;
        }
      });

      /* â€”â€”â€” INTERACTIVITY (unchanged) â€”â€”â€” */
      document.addEventListener("DOMContentLoaded", () => {
        const featured = document.querySelector(".featured-projects");
        const detailContainer = document.querySelector(
          ".selected-project-container"
        );
        const buttons = document.querySelectorAll(".project-btn");
        const featuredCards = featured.querySelectorAll(".project");
        const title = document.getElementById("projects-title");
        let currentId = null;

        const pauseNonLogoVideos = () =>
          document
            .querySelectorAll("video:not(.logo-video)")
            .forEach((v) => v.pause());

        function clearSelection() {
          pauseNonLogoVideos();
          detailContainer
            .querySelectorAll(".selected-project")
            .forEach((d) => (d.style.display = "none"));
          buttons.forEach((b) => b.classList.remove("active"));
          featured.classList.remove("hidden");
          title.textContent = "Projects:";
          currentId = null;
        }

        function selectProject(id) {
          pauseNonLogoVideos();
          featured.classList.add("hidden");

          if (currentId) {
            const prev = detailContainer.querySelector(
              `.selected-project[data-id="${currentId}"]`
            );
            if (prev) prev.style.display = "none";
            document
              .querySelector(`.project-btn[data-id="${currentId}"]`)
              .classList.remove("active");
          }

          const detail = detailContainer.querySelector(
            `.selected-project[data-id="${id}"]`
          );
          if (!detail) return;
          detail.style.display = "block";
          detail.querySelector("video")?.play();
          document
            .querySelector(`.project-btn[data-id="${id}"]`)
            .classList.add("active");
          currentId = id;
          title.scrollIntoView({ behavior: "smooth", block: "start" });
        }

        featuredCards.forEach((card) => {
          const vid = card.querySelector("video");
          card.addEventListener("mouseenter", () => {
            // Pause all other featured videos
            featuredCards.forEach((otherCard) => {
              if (otherCard !== card) {
                const otherVid = otherCard.querySelector("video");
                if (otherVid) otherVid.pause();
              }
            });
            // Pause all drone tracking videos
            const droneVideos = document.querySelectorAll('.drone-videos-layout .media-item video');
            droneVideos.forEach((droneVid) => {
              if (droneVid) droneVid.pause();
            });
            // Play this video
            if (vid.paused && vid.src) vid.play();
          });
          card.addEventListener("click", (e) => {
            if (
              ["a", "video"].includes(e.target.tagName.toLowerCase()) ||
              e.target.closest("video")
            )
              return;
            selectProject(card.dataset.id);
          });
        });

        buttons.forEach((btn) =>
          btn.addEventListener("click", () => {
            btn.dataset.id === currentId
              ? clearSelection()
              : selectProject(btn.dataset.id);
          })
        );

        title.addEventListener("click", () => currentId && clearSelection());

        /* â”€â”€â”€ DRONE TRACKING VIDEO HOVER INTERACTIVITY â”€â”€â”€ */
        const droneVideos = document.querySelectorAll('.drone-videos-layout .media-item');
        droneVideos.forEach((item) => {
          const vid = item.querySelector('video');
          if (vid) {
            item.addEventListener('mouseenter', () => {
              // Pause all other drone videos
              droneVideos.forEach((otherItem) => {
                if (otherItem !== item) {
                  const otherVid = otherItem.querySelector('video');
                  if (otherVid) otherVid.pause();
                }
              });
              // Pause all featured project videos
              featuredCards.forEach((card) => {
                const otherVid = card.querySelector("video");
                if (otherVid) otherVid.pause();
              });
              // Play this video
              if (vid.paused && vid.src) vid.play();
            });
          }
        });
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script>
      /* â”€â”€â”€ SWIPER CAROUSEL INITIALIZATION â”€â”€â”€ */
      document.addEventListener("DOMContentLoaded", () => {
        const swiper = new Swiper('.drone-designs-swiper', {
          effect: 'slide',
          slidesPerView: 1.3,
          spaceBetween: 20,
          centeredSlides: true,
          loop: false,
          watchSlidesProgress: true,
          pagination: {
            el: '.swiper-pagination',
            clickable: true,
            type: 'bullets',
            renderBullet: function (index, className) {
              // Only render 3 bullets (for the 3 unique designs)
              if (index < 3) {
                return '<span class="' + className + '" data-index="' + index + '"></span>';
              }
              return '';
            },
          },
          navigation: {
            nextEl: '.drone-designs-swiper .swiper-button-next',
            prevEl: '.drone-designs-swiper .swiper-button-prev',
          },
          breakpoints: {
            768: {
              slidesPerView: 3,
              spaceBetween: 16,
              centeredSlides: false,
              loop: false,
            }
          },
          on: {
            init: function() {
              updateSlideScale(this);
              updatePagination(this);
            },
            slideChange: function() {
              updateSlideScale(this);
              updatePagination(this);
            },
            transitionEnd: function() {
              updateSlideScale(this);
              updatePagination(this);
            },
          }
        });

        function updatePagination(swiper) {
          const paginationEl = document.querySelector('.drone-designs-swiper .swiper-pagination');
          if (window.innerWidth < 768) {
            if (paginationEl) paginationEl.style.display = 'block';
            const activeSlide = swiper.slides[swiper.activeIndex];
            const designIndex = parseInt(activeSlide.getAttribute('data-design')) - 1;
            const bullets = document.querySelectorAll('.drone-designs-swiper .swiper-pagination-bullet');
            bullets.forEach((bullet, index) => {
              if (index === designIndex) {
                bullet.classList.add('swiper-pagination-bullet-active');
              } else {
                bullet.classList.remove('swiper-pagination-bullet-active');
              }
            });
          } else {
            if (paginationEl) paginationEl.style.display = 'none';
          }
        }

        function updateSlideScale(swiper) {
          if (window.innerWidth < 768) {
            swiper.slides.forEach((slide) => {
              slide.style.transition = 'transform 0.3s ease, opacity 0.3s ease';
              if (slide.classList.contains('swiper-slide-active')) {
                slide.style.transform = 'scale(1)';
                slide.style.opacity = '1';
              } else {
                slide.style.transform = 'scale(0.85)';
                slide.style.opacity = '0.6';
              }
            });
          } else {
            swiper.slides.forEach((slide) => {
              slide.style.transform = '';
              slide.style.opacity = '';
            });
          }
        }

        window.addEventListener('resize', () => {
          swiper.update();
          updateSlideScale(swiper);
          updatePagination(swiper);
        });
      });
    </script>
  </body>
</html>
